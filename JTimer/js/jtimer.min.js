var JTIMER=JTIMER||{};JTIMER.TickerType=Object.freeze({DAY:"dayTicker",HOUR:"hourTicker",MINUTE:"minuteTicker",SECOND:"secondTicker"});JTIMER.Timer=function(element,timerType,targetDate){this.element=element;this.interval=null;this.isTicking=true;this.timerType=timerType;this.targetDate=targetDate;this.remainingTime=JTIMER.Helper.prototype.getRemainingTime(this.targetDate);this.dayTicker=new JTIMER.Ticker(this,JTIMER.TickerType.DAY);this.hourTicker=new JTIMER.Ticker(this,JTIMER.TickerType.HOUR);this.minuteTicker=new JTIMER.Ticker(this,JTIMER.TickerType.MINUTE);this.secondTicker=new JTIMER.Ticker(this,JTIMER.TickerType.SECOND);this.tickerStyle=new JTIMER.TickerStyle();this.dayTickerStyle=new JTIMER.DayTickerStyle();this.hourTickerStyle=new JTIMER.HourTickerStyle();this.minuteTickerStyle=new JTIMER.MinuteTickerStyle();this.secondTickerStyle=new JTIMER.SecondTickerStyle();this.init();};JTIMER.Timer.prototype.init=function(){myTimer=this;this.interval=setInterval(function(){myTimer.loop()},10);};JTIMER.Timer.prototype.loop=function(){this.update();this.checkIfOver();this.render();};JTIMER.Timer.prototype.update=function(){this.remainingTime=JTIMER.Helper.prototype.getRemainingTime(this.targetDate);};JTIMER.Timer.prototype.render=function(){this.dayTicker.render(this.remainingTime);this.hourTicker.render(this.remainingTime);this.minuteTicker.render(this.remainingTime);this.secondTicker.render(this.remainingTime);};JTIMER.Timer.prototype.checkIfOver=function(){if(this.remainingTime<0.1){this.isTicking=false;};};JTIMER.Ticker=function(timer,tickerType){this.timer=timer;this.tickerType=tickerType;this.element=tickerType;this.progressShape=new JTIMER.ProgressShape(this,this.timer.timerType);};JTIMER.Ticker.prototype.render=function(content){denominator=60;label="";switch(this.tickerType){case JTIMER.TickerType.DAY:content=(JTIMER.Helper.prototype.splitDate(content)).days;label="DAYS";denominator=365;break;case JTIMER.TickerType.HOUR:content=(JTIMER.Helper.prototype.splitDate(content)).hours;label="HOURS";denominator=24;break;case JTIMER.TickerType.MINUTE:content=(JTIMER.Helper.prototype.splitDate(content)).minutes;label="MINS";denominator=60;break;case JTIMER.TickerType.SECOND:content=(JTIMER.Helper.prototype.splitDate(content)).seconds;label="SECS";denominator=60;break;default:content=0;break;};this.progressShape.render(content,label,Math.round((content/denominator)*100));};JTIMER.ProgressShape=function(ticker,timerType){this.ticker=ticker;this.timerType=timerType;this.startPoint=1.5;this.tickerStyle=new JTIMER.TickerStyle();this.firstRender=true;this.init();};JTIMER.ProgressShape.prototype.init=function(){document.getElementById(this.ticker.element).innerHTML="<canvas width='720' height='720' class='canvas' id='"+this.ticker.tickerType+"Canvas'></canvas>";this.canvas=document.getElementById(this.ticker.tickerType+"Canvas");this.canvasContext=this.canvas.getContext("2d");};JTIMER.ProgressShape.prototype.render=function(number,label,percentage){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height);this.initStyles();switch(this.timerType){case "Circular":this.circularRender(number,label,percentage);break;case "Box":this.boxRender(number,label,percentage);break;case "Bar":this.barRender(number,label,percentage);break;case "Line":this.lineRender(number,label,percentage);break;default:this.circularRender(number,label,percentage);break;};};JTIMER.ProgressShape.prototype.circularRender=function(number,label,percentage){radius=this.tickerStyle.progressWidth;if(this.tickerStyle.progressWidth>this.tickerStyle.progressBackgroundWidth)radius=((this.canvas.width/2)-(this.tickerStyle.margin))-this.tickerStyle.progressWidth/2;else radius=((this.canvas.width/2)-(this.tickerStyle.margin))-this.tickerStyle.progressBackgroundWidth/2;this.canvasContext.beginPath();this.canvasContext.arc(this.canvas.width/2,this.canvas.height/2,radius-(this.tickerStyle.progressBackgroundWidth/2),0,2*Math.PI);this.canvasContext.fillStyle=this.tickerStyle.backgroundColor;this.canvasContext.fill();this.canvasContext.beginPath();this.canvasContext.arc(this.canvas.width/2,this.canvas.height/2,radius,0,2*Math.PI);this.canvasContext.strokeStyle=this.tickerStyle.progressBackgroundColor;this.canvasContext.lineWidth=this.tickerStyle.progressBackgroundWidth;this.canvasContext.stroke();this.canvasContext.beginPath();this.canvasContext.arc(this.canvas.width/2,this.canvas.height/2,radius,this.startPoint*Math.PI,(this.startPoint-(2*(percentage/100)))*Math.PI,true);this.canvasContext.strokeStyle=this.tickerStyle.progressColor;this.canvasContext.lineWidth=this.tickerStyle.progressWidth;this.canvasContext.stroke();this.renderText(number,label,percentage);};JTIMER.ProgressShape.prototype.boxRender=function(number,label,percentage){this.canvasContext.strokeStyle=this.tickerStyle.progressBackgroundColor;this.canvasContext.lineWidth=this.tickerStyle.progressBackgroundWidth;this.canvasContext.fillStyle=this.tickerStyle.backgroundColor;this.canvasContext.strokeRect(this.tickerStyle.margin,this.tickerStyle.margin,this.canvas.width-this.tickerStyle.margin,this.canvas.height-this.tickerStyle.margin);this.canvasContext.fillRect(this.tickerStyle.margin+this.tickerStyle.progressBackgroundWidth/2,this.tickerStyle.margin+this.tickerStyle.progressBackgroundWidth/2,((this.canvas.width-this.tickerStyle.margin)-this.tickerStyle.progressBackgroundWidth),((this.canvas.height-this.tickerStyle.margin)-this.tickerStyle.progressBackgroundWidth));this.canvasContext.beginPath();this.canvasContext.strokeStyle=this.tickerStyle.progressColor;this.canvasContext.lineWidth=this.tickerStyle.progressWidth;this.canvasContext.moveTo(this.canvas.width/2,this.tickerStyle.margin);coord=this.getCoords(percentage,1);i=2;while(coord!=null){this.canvasContext.lineTo(coord.x,coord.y);coord=this.getCoords(percentage,i);i++;};this.canvasContext.lineWidth=this.tickerStyle.progressWidth;this.canvasContext.strokeStyle=this.tickerStyle.progressColor;this.canvasContext.stroke();this.renderText(number,label,percentage);};JTIMER.ProgressShape.prototype.barRender=function(number,label,percentage){this.canvasContext.beginPath();this.canvasContext.strokeStyle=this.tickerStyle.progressBackgroundColor;this.canvasContext.lineWidth=this.tickerStyle.progressBackgroundWidth;this.canvasContext.fillStyle=this.tickerStyle.progressBackgroundColor;this.canvasContext.fillRect(this.tickerStyle.margin,this.tickerStyle.margin,(this.canvas.width-this.tickerStyle.margin),(this.canvas.height-this.tickerStyle.margin));this.canvasContext.beginPath();this.canvasContext.strokeStyle=this.tickerStyle.progressColor;this.canvasContext.lineWidth=this.tickerStyle.progressWidth;this.canvasContext.fillStyle=this.tickerStyle.progressColor;this.canvasContext.fillRect(this.tickerStyle.margin,(this.canvas.height-this.tickerStyle.margin)-((percentage/100)*((this.canvas.width-this.tickerStyle.margin)-this.tickerStyle.margin)),(this.canvas.width-this.tickerStyle.margin),(this.canvas.height-this.tickerStyle.margin));this.renderText(number,label,percentage);};JTIMER.ProgressShape.prototype.lineRender=function(number,label,percentage){this.canvasContext.beginPath();this.canvasContext.lineWidth=this.tickerStyle.progressBackgroundWidth;this.canvasContext.fillStyle=this.tickerStyle.backgroundColor;this.canvasContext.fillRect(this.tickerStyle.margin+this.tickerStyle.progressBackgroundWidth/2,this.tickerStyle.margin+this.tickerStyle.progressBackgroundWidth/2,((this.canvas.width-this.tickerStyle.margin)-this.tickerStyle.progressBackgroundWidth),((this.canvas.height-this.tickerStyle.margin)-this.tickerStyle.progressBackgroundWidth));this.canvasContext.beginPath();this.canvasContext.strokeStyle=this.tickerStyle.progressColor;this.canvasContext.lineWidth=this.progressWidth;this.canvasContext.moveTo(this.tickerStyle.margin,this.tickerStyle.margin);this.canvasContext.lineTo(this.tickerStyle.margin,this.canvas.height-this.tickerStyle.margin);this.canvasContext.moveTo(this.canvas.width-this.tickerStyle.margin,this.tickerStyle.margin);this.canvasContext.lineTo(this.canvas.width-this.tickerStyle.margin,this.canvas.height-this.tickerStyle.margin);this.canvasContext.lineWidth=this.tickerStyle.progressWidth;this.canvasContext.strokeStyle=this.tickerStyle.progressColor;this.canvasContext.stroke();this.renderText(number,label,percentage);};JTIMER.ProgressShape.prototype.renderText=function(number,label,percentage){this.canvasContext.shadowBlur=30;this.canvasContext.shadowColor="rgba(0,0,0,0.5)";this.canvasContext.font=this.tickerStyle.fontSize+" "+this.tickerStyle.font;this.canvasContext.fillStyle=this.tickerStyle.fontColor;this.canvasContext.fillText(number+" "+label,(this.canvas.width-this.canvasContext.measureText(number+" "+label).width)/2,this.canvas.height/2);this.canvasContext.shadowBlur=0;this.canvasContext.shadowColor="rgba(0,0,0,0)";};JTIMER.ProgressShape.prototype.getCoords=function(percentage,lineSector){if(lineSector==1) if(percentage>12.5){return{x: this.tickerStyle.margin,y: this.tickerStyle.margin};}else {remainingPercent=percentage;remainingPercent/=12.5;width=(this.canvas.width/2)-this.tickerStyle.margin;pointX=(this.canvas.width/2)-(width*remainingPercent);return{x: pointX,y: this.tickerStyle.margin};};if(lineSector==2)if(percentage>37.5){return{x: this.tickerStyle.margin,y: this.canvas.height-this.tickerStyle.margin};}else  if((percentage>=12.5)&&(percentage<37.5)){remainingPercent=percentage-12.5;remainingPercent/=25;height=(this.canvas.height-this.tickerStyle.margin)-this.tickerStyle.margin;pointY=(this.tickerStyle.margin)+(height*remainingPercent);return{x: this.tickerStyle.margin,y: pointY};};if(lineSector==3){if(percentage>62.5){return{x: this.canvas.width-this.tickerStyle.margin,y: this.canvas.height-this.tickerStyle.margin};}else  if((percentage>=37.5)&&(percentage<62.5)){remainingPercent=percentage-37.5;remainingPercent/=25;width=(this.canvas.width-this.tickerStyle.margin)-this.tickerStyle.margin;pointX=(this.tickerStyle.margin)+(width*remainingPercent);return{x: pointX,y: this.canvas.height-this.tickerStyle.margin};};};if(lineSector==4) if(percentage>87.5){return{x: this.canvas.width-this.tickerStyle.margin,y: this.tickerStyle.margin};}else  if((percentage>=62.5)&&(percentage<87.5)){remainingPercent=percentage-62.5;remainingPercent/=25;height=(this.canvas.height-this.tickerStyle.margin)-this.tickerStyle.margin;pointY=(this.canvas.height-this.tickerStyle.margin)-(height*remainingPercent);return{x: this.canvas.width-this.tickerStyle.margin,y: pointY};};if(lineSector==5)if(this.percent>99){return{x: this.canvas.width/2,y: this.tickerStyle.margin};}else  if((percentage>=87.5)&&(percentage<99)){remainingPercent=percentage-87.5;remainingPercent/=12.5;width=(this.canvas.width-this.tickerStyle.margin)-(this.canvas.width/2);pointX=(this.canvas.width/2)+(width-(width*remainingPercent));return{x: pointX,y: this.tickerStyle.margin};};return null;};JTIMER.ProgressShape.prototype.initStyles=function(){tStyle=null;switch(this.ticker.tickerType){case JTIMER.TickerType.DAY:tStyle=this.ticker.timer.dayTickerStyle;break;case JTIMER.TickerType.HOUR:tStyle=this.ticker.timer.hourTickerStyle;break;case JTIMER.TickerType.MINUTE:tStyle=this.ticker.timer.minuteTickerStyle;break;case JTIMER.TickerType.SECOND:tStyle=this.ticker.timer.secondTickerStyle;break;default:tStyle=new JTIMER.TickerStyle();break;};if(tStyle.margin==null)this.tickerStyle.margin=this.ticker.timer.tickerStyle.margin;if(tStyle.backgroundColor==null)this.tickerStyle.backgroundColor=this.ticker.timer.tickerStyle.backgroundColor;if(tStyle.font==null)this.tickerStyle.font=this.ticker.timer.tickerStyle.font;if(tStyle.fontColor==null)this.tickerStyle.fontColor=this.ticker.timer.tickerStyle.fontColor;if(tStyle.fontSize==null)this.tickerStyle.fontSize=this.ticker.timer.tickerStyle.fontSize;if(tStyle.progressColor==null)this.tickerStyle.progressColor=this.ticker.timer.tickerStyle.progressColor;if(tStyle.progressWidth==null)this.tickerStyle.progressWidth=this.ticker.timer.tickerStyle.progressWidth;if(tStyle.progressBackgroundColor==null)this.tickerStyle.progressBackgroundColor=this.ticker.timer.tickerStyle.progressBackgroundColor;if(tStyle.progressBackgroundWidth==null)this.tickerStyle.progressBackgroundWidth=this.ticker.timer.tickerStyle.progressBackgroundWidth;switch(this.ticker.tickerType){case JTIMER.TickerType.DAY:this.ticker.timer.dayTickerStyle=tStyle;break;case JTIMER.TickerType.HOUR:this.ticker.timer.hourTickerStyle=tStyle;break;case JTIMER.TickerType.MINUTE:this.ticker.timer.minuteTickerStyle=tStyle;break;case JTIMER.TickerType.SECOND:this.ticker.timer.secondTickerStyle=tStyle;break;default:break;};this.tickerStyle=tStyle;};JTIMER.TickerStyle=function(){this.margin=5;this.backgroundColor="rgba(0,0,0,0)";this.font="Arial";this.fontColor="rgba(255,255,255,1)";this.fontSize="100px";this.progressColor="rgba(255,255,255,1)";this.progressWidth=50;this.progressBackgroundColor="rgba(0,0,0,0.1)";this.progressBackgroundWidth=50;};JTIMER.DayTickerStyle=function(){this.margin=null;this.backgroundColor=null;this.font=null;this.fontColor=null;this.fontSize=null;this.progressColor=null;this.progressWidth=null;this.progressBackgroundColor=null;this.progressBackgroundWidth=null;};JTIMER.HourTickerStyle=function(){this.margin=null;this.backgroundColor=null;this.font=null;this.fontColor=null;this.fontSize=null;this.progressColor=null;this.progressWidth=null;this.progressBackgroundColor=null;this.progressBackgroundWidth=null;};JTIMER.MinuteTickerStyle=function(){this.margin=null;this.backgroundColor=null;this.font=null;this.fontColor=null;this.fontSize=null;this.progressColor=null;this.progressWidth=null;this.progressBackgroundColor=null;this.progressBackgroundWidth=null;};JTIMER.SecondTickerStyle=function(){this.margin=null;this.backgroundColor=null;this.font=null;this.fontColor=null;this.fontSize=null;this.progressColor=null;this.progressWidth=null;this.progressBackgroundColor=null;this.progressBackgroundWidth=null;};JTIMER.Helper=function(){};JTIMER.Helper.prototype.getRemainingTime=function(targetDate){now=new Date();milliseconds=targetDate-now;if(milliseconds/1000<0.1)milliseconds =0;return milliseconds;};JTIMER.Helper.prototype.splitDate=function(milliseconds){d=milliseconds/86400000;milliseconds %= 86400000;h=milliseconds/3600000;milliseconds %= 3600000;m=milliseconds/60000;milliseconds %= 60000;s=milliseconds/1000;return{days:Math.floor(d),hours:Math.floor(h),minutes:Math.floor(m),seconds:Math.floor(s)};};